OutDrillMove = 5Const InTool1 = 12Const InTool2 = 13Const InTool3 = 14Const InTool4 = 15Message "Enable 4 active " & IsOutputActive(4) Call StartDrill()Sub StartDrill	ToolComb = GetCombination()	ToolNum = SwCaseReverse(ToolComb)	If(ToolNum = 5 Or ToolNum = 6) Then		Message "Drill Started..."		Call SetCsmioOutEx(6, True)	Else		Message "Can't start drill with current tool"		End	End IfEnd SubSub StopDrill	Call SetCsmioOutEx(6, False)	Message "Drill Stopped."End SubSub GetCombination()	Dim Comb	Comb = ""	If(GetCsmioIn(InTool1) = False) Then		Comb =  Comb + "0"	Else		Comb =  Comb + "1"	End If	If(GetCsmioIn(InTool2) = False) Then		Comb =  Comb + "0"	Else		Comb =  Comb + "1"	End If	If(GetCsmioIn(InTool3) = False) Then		Comb =  Comb + "0"	Else		Comb =  Comb + "1"	End If	If(GetCsmioIn(InTool4) = False) Then		Comb =  Comb + "0"	Else		Comb =  Comb + "1"	End If	GetCombination = CombEnd SubPublic Sub SwCaseReverse(Comb)	Dim Namba	Select Case Comb		Case "0000"			Namba = 1			Message "Tool 1 Selected 0000"		Case "0001"			Namba = 2			Message "Tool 2 Selected 0001"		Case "0011"			Namba = 3			Message "Tool 3 Selected 0011"		Case "0010"			Namba = 4			Message "Tool 4 Selected 0010"		Case "1010"			Namba = 5			Message "Tool 5 Selected 1010"		Case "1011"			Namba = 6			Message "Tool 6 Selected 1011"		Case "1111"			Namba = 7			Message "Tool 7 Selected 1111"		Case "0111"			Namba = 8			Message "Tool 8 Selected 0111"		Case "0110"			Namba = 9			Message "Tool 9 Selected 0110"		Case "1110"			Namba = 10			Message "Tool 10 Selected 1110"		Case "1100"			Namba = 11			Message "Tool 11 Selected 1100"		Case "0100"			Namba = 12			Message "Tool 12 Selected 0100"		Case "0101"			Namba = 13			Message "Tool 13 Selected 0101"		Case "1101"			Namba = 14			Message "Tool 14 Selected 1101"		Case "1001"			Namba = 15			Message "Tool 15 Selected 1001"		Case "1000"			Namba = 16			Message "Tool 16 Selected 1000"		Case Else			Message "Tool Out of Range"			Sleep(50)			End	End Select	SwCaseReverse = Namba  End SubPublic Sub SetCsmioOutEx(ByVal n As Integer, ByVal state As Boolean)	If(state) Then		SetOutBit(100, n)	Else		ResetOutBit(100, n)	End IfEnd SubPublic Function GetCsmioIn(n As Integer) As Boolean	Dim reg As Integer	If(n<16) Then		reg = 90	Else		reg = 91		n = n-16	End If	If(GetInBit(reg, n)) Then		GetCsmioIn = true	Else		GetCsmioIn = False	End If	Exit FunctionEnd Function