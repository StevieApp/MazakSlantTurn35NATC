''DoSpinCCW()OutMesh = 11OutBrakeRelease = 7OutBrakeChuck = 12OutUnmesh = 10OutSpindleReset = 9Const InUnMeshed = 3Const InReset = 4Const InMeshState = 6Const InMeshed = 5''Call Unmesh()Call StartCCW()Sub StartCCW	Dim UnMeshed, ResetState, MeshStatus, Meshed	UnMeshed = GetCsmioIn(InUnMeshed)	ResetState = GetCsmioIn(InReset)	MeshStatus = GetCsmioIn(InMeshState)	Meshed = GetCsmioIn(InMeshed)	If Unmeshed = True Or ResetState = True Or MeshStatus = True Or Meshed = False Then		Call BrakeRelease()		Call Unmesh()		Call Mesh()		DoSpinCCW()	Else		DoSpinCCW()	End IfEnd SubSub Mesh	Message "Meshing..."	Call SetCsmioOut(OutSpindleReset, True)	Sleep(2200)	Call SetCsmioOut(OutSpindleReset, False)	Sleep(100)	Call SetCsmioOut(OutMesh, True)	Sleep(3200)	Call SetCsmioOut(OutMesh, False)	Message "Meshed."End SubSub BrakeRelease	Call SetCsmioOut(OutBrakeRelease, True)	Sleep(2200)	Call SetCsmioOut(OutBrakeRelease, False)End SubSub Unmesh	Call SetCsmioOut(OutSpindleReset, True)	Sleep(2200)	Call SetCsmioOut(OutSpindleReset, False)	Sleep(100)	Call SetCsmioOut(OutUnmesh, True)	Sleep(3200)	Call SetCsmioOut(OutUnmesh, False)End SubPublic Sub SetCsmioOut(ByVal n As Integer, ByVal state As Boolean)	If(state) Then		SetOutBit(90, n)	Else		ResetOutBit(90, n)	End IfEnd SubPublic Sub SetCsmioOutEx(ByVal n As Integer, ByVal state As Boolean)	If(state) Then		SetOutBit(100, n)	Else		ResetOutBit(100, n)	End IfEnd Sub   Public Function GetCsmioIn(n As Integer) As Boolean	Dim reg As Integer	If(n<16) Then		reg = 90	Else		reg = 91		n = n-16	End If	If(GetInBit(reg, n)) Then		GetCsmioIn = true	Else		GetCsmioIn = False	End If	Exit FunctionEnd Function      